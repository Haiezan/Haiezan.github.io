---
layout:     post
title:      连接远程电脑的时候提示：此计算机无法连接到远程计算机
subtitle:   网络
date:       2021-03-12
author:     JS
header-img: img/post-bg-code.jpg
catalog: true
tags:
    - 网络
    - 远程桌面
---

本人遇到问题一，采用方法6，成功解决问题。
特此转官方解决方案以推广，文末附链接。

## 一、无法从客户端连接到远端
错误情况大致为：“此计算机无法连接到远程计算机。请尝试重新连接，如果问题仍然存在，请联系远程计算机的所有者或网络管理员”

解决方法：

1、检查防火墙是否开启，是否将3389端口或“远程桌面”服务列为例外，如果没有，请关闭防火墙或将此服务列为例外；

2、检查是否开启TCP/IP筛选，ncpa.cpl打开网络连接，右键“本地连接”--“属性”--“TCP/IP属性”--“高级”--“选项”--“TCP/IP筛选”--“属性”，在此查看是否有不利于远程桌面端口通过的筛选，如果有，请将TCP/IP筛选关闭或重新定义筛选端口；

3、进入services.msc检查一个重要的服务是否开启，Terminal Services，这是远程桌面所必需的服务，一般把此服务开启并确保Windows Firewall服务关闭大部分问题就可以解决了，但是我们可能还会忽略一些事情；

4、查看杀毒软件或服务器上的安全产品是否进行过升级，一些杀毒软件也会自带一些安全功能，他们认为远程桌面端口太过危险，所以就将其禁用掉，如果以上3条还不可行，可检查杀毒软件或安全产品的配置，或直接将其卸载；

5、进入组策略，检查下面的ipsec安全策略是否有指派过阻止远程连接端口的策略，如果有，请重新定义策略或将其定义为“不指派”；

6、端口冲突，也许为了安全，很多人在配置服务器时会手动将远程桌面的默认端口（3389）改掉，这样确实能够防止大量的端口试探，但是如果该服务器上所安装的软件很多，就会在无意间造成端口冲突，造成你可能在重启服务器前还能连上远程桌面，但重启后就怎么也连不上了，如果上的方法都试过了不行，那么最后一个可能就是你的解决办法。首先regedit进入注注表：\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp，在此有一个portnumber，将其更改为其他端口号，然后是HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp，这下面也有一个portnumber，将其该为和上面一样的端口号即可，如果你不确定是不是端口冲突造成的无法连接，可以在以上两个注册表项中先将端口改回默认的3389，如果这样可以连接，那么说明确实是端口冲突，改完注册表需要重启生效！


## 二、连接到远程桌面但是无法登陆，显示没有权限

解决方法：

进入组策略--计算机配置--Windows设置--安全设置--本地策略--用户权利指派，检查“通过终端服务拒绝登录”中有没有你需要登录的用户，如果有，请将其删除，“通过终端服务允许登录”要加入你需要登录的用户